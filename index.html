<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Como Latte ‚Äî Gu√≠a de Caf√©s</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      /* üé® Paleta Como Latte */
      --cl-espresso:#3B2F2F;
      --cl-cacao:#5A4634;
      --cl-latte:#D8C3A5;
      --cl-crema:#F3E9DC;
      --cl-foam:#FCF8F3;
      --cl-accent:#C69C6D;

      --bg: linear-gradient(180deg, var(--cl-foam), var(--cl-crema));
      --surface: #ffffffee;
      --border: #e7dfd6;
      --ink: #2b2725;
      --muted:#6a5f58;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;background:var(--bg);color:var(--ink)}
    header{position:sticky;top:0;background:linear-gradient(180deg, #ffffffee, #ffffffcc 70%, transparent);backdrop-filter:saturate(160%) blur(8px);z-index:10;border-bottom:1px solid var(--border)}
    .wrap{max-width:1100px;margin:0 auto;padding:18px}
    h1{margin:4px 0 2px;font-size:28px;letter-spacing:.2px;color:var(--cl-espresso)}
    .subtitle{margin:0 0 14px;color:var(--muted)}

    .controls{display:grid;grid-template-columns:1.2fr 1fr .9fr 1fr;gap:10px}
    .control{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:10px}
    .label{font-size:12px;color:var(--muted);margin-bottom:6px}
    input[type="text"],select,input[type="number"],input[type="range"]{
      width:100%;background:#fff;border:1px solid var(--border);border-radius:10px;padding:10px;outline:none;color:var(--ink)
    }
    .ranges{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px}
    .range{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:10px}
    .range .val{font-variant-numeric:tabular-nums}
    .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    button{background:var(--cl-accent);border:0;border-radius:12px;padding:10px 12px;font-weight:700;color:#fff;cursor:pointer}
    .ghost{background:transparent;color:var(--cl-cacao);border:1px solid var(--border)}

    main{padding:14px 0 60px}
    .grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:14px}
    @media (max-width: 1000px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
    @media (max-width: 680px){
      .controls{grid-template-columns:1fr 1fr}
      .ranges{grid-template-columns:1fr 1fr}
      .grid{grid-template-columns:1fr}
    }

    .card{background:#fff;border:1px solid var(--border);border-radius:18px;padding:14px;display:flex;flex-direction:column;gap:8px;box-shadow:0 6px 20px rgba(59,47,47,.06)}
    .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .badge{background:var(--cl-espresso);color:#fff;padding:6px 10px;border-radius:12px;font-weight:800;letter-spacing:.2px}
    .city{font-size:13px;color:var(--muted)}
    .progress{height:8px;width:100%;background:var(--cl-foam);border:1px solid var(--border);border-radius:999px;overflow:hidden}
    .bar{height:100%;background:linear-gradient(90deg, var(--cl-accent), #e7c79c)}
    .meta{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px;font-size:12px}
    .meta div{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:8px}

    .chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .chip{background:var(--surface);border:1px solid var(--border);border-radius:999px;padding:6px 10px;font-size:12px;color:var(--muted)}

    footer{color:var(--muted);font-size:12px;padding:24px 0 60px}
    a{color:var(--cl-espresso)}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Como Latte ‚Äî Gu√≠a de Caf√©s</h1>
      <p class="subtitle">Buscador bonito, con filtros por ciudad y categor√≠as ponderadas: Local, Caf√©, M√∫sica, Servicio, Ubicaci√≥n y Precio.</p>

      <div class="controls">
        <div class="control">
          <div class="label">Buscar</div>
          <input id="q" type="text" placeholder="Nombre o ciudad‚Ä¶" />
        </div>
        <div class="control">
          <div class="label">Ciudad</div>
          <select id="city"><option value="">Todas</option></select>
        </div>
        <div class="control">
          <div class="label">Nota final m√≠nima</div>
          <input id="minFinal" type="number" min="0" max="10" step="0.1" value="0" />
        </div>
        <div class="control">
          <div class="label">Ordenar por</div>
          <select id="sort">
            <option value="NotaFinal-desc">Nota final ‚Üì</option>
            <option value="NotaFinal-asc">Nota final ‚Üë</option>
            <option value="Caf√©-asc">Nombre A‚ÜíZ</option>
            <option value="Ciudad-asc">Ciudad A‚ÜíZ</option>
          </select>
        </div>
      </div>

      <div class="ranges" style="margin-top:10px">
        <div class="range">
          <div class="label">Local (m√≠n)</div>
          <input id="minLocal" type="range" min="0" max="10" step="0.1" value="0" />
          <div class="label"><span class="val" id="valLocal">0.0</span></div>
        </div>
        <div class="range">
          <div class="label">Caf√© (m√≠n)</div>
          <input id="minCafe" type="range" min="0" max="10" step="0.1" value="0" />
          <div class="label"><span class="val" id="valCafe">0.0</span></div>
        </div>
        <div class="range">
          <div class="label">M√∫sica (m√≠n)</div>
          <input id="minMusica" type="range" min="0" max="10" step="0.1" value="0" />
          <div class="label"><span class="val" id="valMusica">0.0</span></div>
        </div>
        <div class="range">
          <div class="label">Servicio (m√≠n)</div>
          <input id="minServicio" type="range" min="0" max="10" step="0.1" value="0" />
          <div class="label"><span class="val" id="valServicio">0.0</span></div>
        </div>
        <div class="range">
          <div class="label">Ubicaci√≥n (m√≠n)</div>
          <input id="minUbicacion" type="range" min="0" max="10" step="0.1" value="0" />
          <div class="label"><span class="val" id="valUbicacion">0.0</span></div>
        </div>
        <div class="range">
          <div class="label">Precio (m√≠n)</div>
          <input id="minPrecio" type="range" min="0" max="10" step="0.1" value="0" />
          <div class="label"><span class="val" id="valPrecio">0.0</span></div>
        </div>
      </div>

      <div class="actions">
        <input id="file" type="file" accept="application/json" />
        <button id="reset" class="ghost">Reset filtros</button>
        <div class="chip" id="count">Resultados: 0</div>
      </div>
      <div class="chips" id="chips"></div>
    </div>
  </header>

  <main class="wrap">
    <div class="grid" id="grid"></div>
    <footer>
      Hecho con ‚ù§ por Ignacio & Francisca / Como Latte. Pesos: Local 27,5%, Caf√© 35%, M√∫sica 10%, Servicio 7,5%, Ubicaci√≥n 12,5%, Precio 7,5%.
      <br/>Este HTML es est√°tico (sin servidor). Puedes embeber los datos abajo o importar un JSON.
    </footer>
  </main>

  <script id="data" type="application/json">[{"Caf√©": "Wanna Place", "Ciudad": "Barcelona", "NotaFinal": 9.03, "Local (27,5%)": 9.75, "M√∫sica (10%)": 9.0, "Servicio (7,5%)": 7.5, "Caf√© (35%)": 10.0, "Ubicaci√≥n (12,5%)": 7.5, "Precio (7,5%)": 6.0, "I": 9.5, "F": 10.0}, {"Caf√©": "Ikenocha fusion", "Ciudad": "Barcelona", "NotaFinal": 8.94, "Local (27,5%)": 8.65, "M√∫sica (10%)": 9.25, "Servicio (7,5%)": 8.7, "Caf√© (35%)": 10.0, "Ubicaci√≥n (12,5%)": 8.85, "Precio (7,5%)": 5.0, "I": 8.8, "F": 8.5}, {"Caf√©": "Bykate", "Ciudad": "Barcelona", "NotaFinal": 8.8, "Local (27,5%)": 9.35, "M√∫sica (10%)": 8.5, "Servicio (7,5%)": 8.0, "Caf√© (35%)": 8.75, "Ubicaci√≥n (12,5%)": 8.0, "Precio (7,5%)": 9.5, "I": 9.2, "F": 9.5}, {"Caf√©": "Annna", "Ciudad": "Sant Feliu de Gu√≠xols", "NotaFinal": 8.78, "Local (27,5%)": 8.75, "M√∫sica (10%)": 8.75, "Servicio (7,5%)": 8.5, "Caf√© (35%)": 9.62, "Ubicaci√≥n (12,5%)": 7.75, "Precio (7,5%)": 7.0, "I": 8.7, "F": 8.8}, {"Caf√©": "Vera cafe", "Ciudad": "Barcelona", "NotaFinal": 8.78, "Local (27,5%)": 9.65, "M√∫sica (10%)": 10.0, "Servicio (7,5%)": 7.5, "Caf√© (35%)": 8.25, "Ubicaci√≥n (12,5%)": 8.6, "Precio (7,5%)": 8.0, "I": 9.5, "F": 9.8}, {"Caf√©": "Rex cafe", "Ciudad": "Barcelona", "NotaFinal": 8.75, "Local (27,5%)": 9.4, "M√∫sica (10%)": 9.6, "Servicio (7,5%)": 8.0, "Caf√© (35%)": 8.85, "Ubicaci√≥n (12,5%)": 8.0, "Precio (7,5%)": 6.75, "I": 9.3, "F": 9.5}, {"Caf√©": "Slitti", "Ciudad": "Barcelona", "NotaFinal": 8.74, "Local (27,5%)": 9.6, "M√∫sica (10%)": 7.5, "Servicio (7,5%)": 10.0, "Caf√© (35%)": 9.0, "Ubicaci√≥n (12,5%)": 8.6, "Precio (7,5%)": 5.0, "I": 9.7, "F": 9.5}, {"Caf√©": "Lot roasters", "Ciudad": "Barcelona", "NotaFinal": 8.71, "Local (27,5%)": 8.75, "M√∫sica (10%)": 8.25, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 10.0, "Ubicaci√≥n (12,5%)": 8.0, "Precio (7,5%)": 6.0, "I": 8.7, "F": 8.8}, {"Caf√©": "Nudes", "Ciudad": "Barcelona", "NotaFinal": 8.67, "Local (27,5%)": 8.75, "M√∫sica (10%)": 9.75, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 9.25, "Ubicaci√≥n (12,5%)": 8.0, "Precio (7,5%)": 7.0, "I": 8.5, "F": 9.0}, {"Caf√©": "Noor coffee gracia", "Ciudad": "Barcelona", "NotaFinal": 8.66, "Local (27,5%)": 8.5, "M√∫sica (10%)": 10.0, "Servicio (7,5%)": 9.25, "Caf√© (35%)": 8.5, "Ubicaci√≥n (12,5%)": 9.0, "Precio (7,5%)": 7.0, "I": 8.5, "F": 8.5}, {"Caf√©": "Jac", "Ciudad": "Barcelona", "NotaFinal": 8.64, "Local (27,5%)": 9.1, "M√∫sica (10%)": 8.25, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 9.0, "Ubicaci√≥n (12,5%)": 8.25, "Precio (7,5%)": 8.1, "I": 9.2, "F": 9.0}, {"Caf√©": "Maldita barra", "Ciudad": "Barcelona", "NotaFinal": 8.59, "Local (27,5%)": 9.6, "M√∫sica (10%)": 8.5, "Servicio (7,5%)": 8.0, "Caf√© (35%)": 8.5, "Ubicaci√≥n (12,5%)": 8.6, "Precio (7,5%)": 6.0, "I": 9.2, "F": 10.0}, {"Caf√©": "Aeroplano Cofe", "Ciudad": "Barcelona", "NotaFinal": 8.57, "Local (27,5%)": 9.5, "M√∫sica (10%)": 6.0, "Servicio (7,5%)": 10.0, "Caf√© (35%)": 9.6, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 5.0, "I": 9.5, "F": 9.5}, {"Caf√©": "Caf√© de l'Arquitecte", "Ciudad": "Barcelona", "NotaFinal": 8.57, "Local (27,5%)": 9.0, "M√∫sica (10%)": 7.5, "Servicio (7,5%)": 9.7, "Caf√© (35%)": 8.0, "Ubicaci√≥n (12,5%)": 9.0, "Precio (7,5%)": 9.25, "I": 9.0, "F": 9.0}, {"Caf√©": "The miners coffee", "Ciudad": "Barcelona", "NotaFinal": 8.56, "Local (27,5%)": 9.0, "M√∫sica (10%)": 9.0, "Servicio (7,5%)": 8.5, "Caf√© (35%)": 8.75, "Ubicaci√≥n (12,5%)": 8.6, "Precio (7,5%)": 5.5, "I": 9.0, "F": 9.0}, {"Caf√©": "Raw", "Ciudad": "Barcelona", "NotaFinal": 8.51, "Local (27,5%)": 7.75, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 9.0, "Caf√© (35%)": 9.0, "Ubicaci√≥n (12,5%)": 8.6, "Precio (7,5%)": 9.0, "I": 6.5, "F": 9.0}, {"Caf√©": "Roast club", "Ciudad": "Barcelona", "NotaFinal": 8.46, "Local (27,5%)": 8.0, "M√∫sica (10%)": 9.0, "Servicio (7,5%)": 9.5, "Caf√© (35%)": 8.75, "Ubicaci√≥n (12,5%)": 8.5, "Precio (7,5%)": 7.0, "I": 8.5, "F": 7.5}, {"Caf√©": "Chromatic", "Ciudad": "Barcelona", "NotaFinal": 8.44, "Local (27,5%)": 9.7, "M√∫sica (10%)": 9.0, "Servicio (7,5%)": 7.25, "Caf√© (35%)": 8.0, "Ubicaci√≥n (12,5%)": 7.25, "Precio (7,5%)": 8.25, "I": 9.7, "F": 9.7}, {"Caf√©": "Cofi", "Ciudad": "Madrid", "NotaFinal": 8.43, "Local (27,5%)": 8.35, "M√∫sica (10%)": 8.75, "Servicio (7,5%)": 9.0, "Caf√© (35%)": 9.0, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 7.5, "I": 8.0, "F": 8.7}, {"Caf√©": "Hola coffee", "Ciudad": "Madrid", "NotaFinal": 8.43, "Local (27,5%)": 8.0, "M√∫sica (10%)": 8.5, "Servicio (7,5%)": 7.5, "Caf√© (35%)": 9.5, "Ubicaci√≥n (12,5%)": 8.0, "Precio (7,5%)": 6.5, "I": 8.0, "F": 8.0}, {"Caf√©": "Kfika", "Ciudad": "Barcelona", "NotaFinal": 8.42, "Local (27,5%)": 8.85, "M√∫sica (10%)": 7.75, "Servicio (7,5%)": 9.0, "Caf√© (35%)": 8.75, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 8.0, "I": 8.7, "F": 9.0}, {"Caf√©": "Kuji coffee", "Ciudad": "Oporto", "NotaFinal": 8.4, "Local (27,5%)": 8.85, "M√∫sica (10%)": 8.15, "Servicio (7,5%)": 8.25, "Caf√© (35%)": 9.3, "Ubicaci√≥n (12,5%)": 6.0, "Precio (7,5%)": 7.0, "I": 8.7, "F": 9.0}, {"Caf√©": "Noshi coffee", "Ciudad": "Oporto", "NotaFinal": 8.39, "Local (27,5%)": 9.35, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 6.5, "Caf√© (35%)": 7.75, "Ubicaci√≥n (12,5%)": 9.15, "Precio (7,5%)": 9.0, "I": 9.2, "F": 9.5}, {"Caf√©": "Abyss coffee", "Ciudad": "Barcelona", "NotaFinal": 8.37, "Local (27,5%)": 9.15, "M√∫sica (10%)": 9.25, "Servicio (7,5%)": 7.5, "Caf√© (35%)": 8.5, "Ubicaci√≥n (12,5%)": 7.5, "Precio (7,5%)": 6.0, "I": 9.0, "F": 9.3}, {"Caf√©": "Simpli coffee", "Ciudad": "Oporto", "NotaFinal": 8.36, "Local (27,5%)": 9.4, "M√∫sica (10%)": 8.85, "Servicio (7,5%)": 8.0, "Caf√© (35%)": 8.2, "Ubicaci√≥n (12,5%)": 8.25, "Precio (7,5%)": 5.25, "I": 9.0, "F": 9.8}, {"Caf√©": "Balzac", "Ciudad": "Barcelona", "NotaFinal": 8.36, "Local (27,5%)": 8.8, "M√∫sica (10%)": 7.5, "Servicio (7,5%)": 7.5, "Caf√© (35%)": 8.5, "Ubicaci√≥n (12,5%)": 9.0, "Precio (7,5%)": 7.0, "I": 8.8, "F": 8.8}, {"Caf√©": "Indigo cafe", "Ciudad": "Barcelona", "NotaFinal": 8.35, "Local (27,5%)": 8.25, "M√∫sica (10%)": 7.38, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 8.5, "Ubicaci√≥n (12,5%)": 8.75, "Precio (7,5%)": 10.0, "I": 8.0, "F": 8.5}, {"Caf√©": "Lady badka", "Ciudad": "Barcelona", "NotaFinal": 8.33, "Local (27,5%)": 9.0, "M√∫sica (10%)": 8.25, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 8.2, "Ubicaci√≥n (12,5%)": 8.6, "Precio (7,5%)": 7.5, "I": 9.0, "F": 9.0}, {"Caf√©": "Three marks Coffee", "Ciudad": "Barcelona", "NotaFinal": 8.33, "Local (27,5%)": 8.25, "M√∫sica (10%)": 6.5, "Servicio (7,5%)": 8.0, "Caf√© (35%)": 9.25, "Ubicaci√≥n (12,5%)": 9.0, "Precio (7,5%)": 6.0, "I": 8.5, "F": 8.0}, {"Caf√©": "Camelia art caf√©", "Ciudad": "Barcelona", "NotaFinal": 8.33, "Local (27,5%)": 8.75, "M√∫sica (10%)": 8.25, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 8.5, "Ubicaci√≥n (12,5%)": 8.0, "Precio (7,5%)": 8.0, "I": 8.5, "F": 9.0}, {"Caf√©": "Grace coffee", "Ciudad": "Platja d'Aro", "NotaFinal": 8.33, "Local (27,5%)": 7.92, "M√∫sica (10%)": 9.0, "Servicio (7,5%)": 10.0, "Caf√© (35%)": 7.5, "Ubicaci√≥n (12,5%)": 9.0, "Precio (7,5%)": 10.0, "I": 7.85, "F": 8.0}, {"Caf√©": "An√≠s caf√©", "Ciudad": "Barcelona", "NotaFinal": 8.33, "Local (27,5%)": 8.25, "M√∫sica (10%)": 9.0, "Servicio (7,5%)": 7.25, "Caf√© (35%)": 8.35, "Ubicaci√≥n (12,5%)": 8.6, "Precio (7,5%)": 8.25, "I": 8.0, "F": 8.5}, {"Caf√©": "Apurado Caf√©", "Ciudad": "Barcelona", "NotaFinal": 8.32, "Local (27,5%)": 8.7, "M√∫sica (10%)": 9.0, "Servicio (7,5%)": 7.25, "Caf√© (35%)": 8.75, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 7.25, "I": 8.5, "F": 8.9}, {"Caf√©": "Osom", "Ciudad": "Barcelona", "NotaFinal": 8.31, "Local (27,5%)": 8.55, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 6.25, "Caf√© (35%)": 9.0, "Ubicaci√≥n (12,5%)": 7.25, "Precio (7,5%)": 8.5, "I": 8.6, "F": 8.5}, {"Caf√©": "Nomad coffee", "Ciudad": "Barcelona", "NotaFinal": 8.31, "Local (27,5%)": 8.25, "M√∫sica (10%)": 7.6, "Servicio (7,5%)": 6.25, "Caf√© (35%)": 9.85, "Ubicaci√≥n (12,5%)": 6.1, "Precio (7,5%)": 8.0, "I": 8.0, "F": 8.5}, {"Caf√©": "So coffee", "Ciudad": "Oporto", "NotaFinal": 8.27, "Local (27,5%)": 8.35, "M√∫sica (10%)": 8.22, "Servicio (7,5%)": 9.5, "Caf√© (35%)": 8.5, "Ubicaci√≥n (12,5%)": 7.62, "Precio (7,5%)": 6.85, "I": 8.2, "F": 8.5}, {"Caf√©": "Slowmov", "Ciudad": "Barcelona", "NotaFinal": 8.27, "Local (27,5%)": 7.65, "M√∫sica (10%)": 7.0, "Servicio (7,5%)": 8.0, "Caf√© (35%)": 9.5, "Ubicaci√≥n (12,5%)": 7.35, "Precio (7,5%)": 9.0, "I": 7.5, "F": 7.8}, {"Caf√©": "Philosofia", "Ciudad": "Barcelona", "NotaFinal": 8.16, "Local (27,5%)": 9.75, "M√∫sica (10%)": 9.25, "Servicio (7,5%)": 8.0, "Caf√© (35%)": 6.5, "Ubicaci√≥n (12,5%)": 9.25, "Precio (7,5%)": 7.0, "I": 9.5, "F": 10.0}, {"Caf√©": "P88", "Ciudad": "Copenhague", "NotaFinal": 8.16, "Local (27,5%)": 9.85, "M√∫sica (10%)": 9.0, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 7.5, "Ubicaci√≥n (12,5%)": 10.0, "Precio (7,5%)": 3.0, "I": 9.7, "F": 10.0}, {"Caf√©": "T.44", "Ciudad": "Barcelona", "NotaFinal": 8.14, "Local (27,5%)": 7.25, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 9.0, "Caf√© (35%)": 9.05, "Ubicaci√≥n (12,5%)": 7.4, "Precio (7,5%)": 7.75, "I": 7.5, "F": 7.0}, {"Caf√©": "LA PAPA", "Ciudad": "Barcelona", "NotaFinal": 8.14, "Local (27,5%)": 9.6, "M√∫sica (10%)": 9.4, "Servicio (7,5%)": 7.75, "Caf√© (35%)": 7.5, "Ubicaci√≥n (12,5%)": 7.25, "Precio (7,5%)": 6.0, "I": 9.7, "F": 9.5}, {"Caf√©": "La casa amande", "Ciudad": "Madrid", "NotaFinal": 8.14, "Local (27,5%)": 8.9, "M√∫sica (10%)": 7.75, "Servicio (7,5%)": 7.5, "Caf√© (35%)": 8.0, "Ubicaci√≥n (12,5%)": 8.5, "Precio (7,5%)": 6.5, "I": 8.8, "F": 9.0}, {"Caf√©": "Ay street coffee", "Ciudad": "Oporto", "NotaFinal": 8.12, "Local (27,5%)": 8.75, "M√∫sica (10%)": 7.5, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 8.75, "Ubicaci√≥n (12,5%)": 9.25, "Precio (7,5%)": 4.0, "I": 8.5, "F": 9.0}, {"Caf√©": "Dirty rabbit", "Ciudad": "Sagaro", "NotaFinal": 8.12, "Local (27,5%)": 8.65, "M√∫sica (10%)": 7.5, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 7.9, "Ubicaci√≥n (12,5%)": 8.8, "Precio (7,5%)": 8.0, "I": 8.3, "F": 9.0}, {"Caf√©": "Morrow cafe", "Ciudad": "Barcelona", "NotaFinal": 8.11, "Local (27,5%)": 8.5, "M√∫sica (10%)": 6.0, "Servicio (7,5%)": 7.35, "Caf√© (35%)": 8.75, "Ubicaci√≥n (12,5%)": 8.85, "Precio (7,5%)": 6.0, "I": 8.5, "F": 8.5}, {"Caf√©": "JOMO coffee", "Ciudad": "Barcelona", "NotaFinal": 8.1, "Local (27,5%)": 8.0, "M√∫sica (10%)": 8.5, "Servicio (7,5%)": 7.5, "Caf√© (35%)": 8.4, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 9.0, "I": 8.0, "F": 8.0}, {"Caf√©": "Bonsai cafe", "Ciudad": "Barcelona", "NotaFinal": 8.06, "Local (27,5%)": 8.5, "M√∫sica (10%)": 6.0, "Servicio (7,5%)": 9.0, "Caf√© (35%)": 8.75, "Ubicaci√≥n (12,5%)": 7.5, "Precio (7,5%)": 6.0, "I": 8.5, "F": 8.5}, {"Caf√©": "Saga Coffee", "Ciudad": "Barcelona", "NotaFinal": 8.03, "Local (27,5%)": 8.75, "M√∫sica (10%)": 9.0, "Servicio (7,5%)": 7.5, "Caf√© (35%)": 7.25, "Ubicaci√≥n (12,5%)": 7.75, "Precio (7,5%)": 8.75, "I": 8.5, "F": 9.0}, {"Caf√©": "Central caf√©", "Ciudad": "Barcelona", "NotaFinal": 8.01, "Local (27,5%)": 9.1, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 7.0, "Ubicaci√≥n (12,5%)": 9.35, "Precio (7,5%)": 7.5, "I": 9.0, "F": 9.2}, {"Caf√©": "My coffee Porto", "Ciudad": "Oporto", "NotaFinal": 7.97, "Local (27,5%)": 7.75, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 6.5, "Caf√© (35%)": 7.9, "Ubicaci√≥n (12,5%)": 9.5, "Precio (7,5%)": 8.0, "I": 7.5, "F": 8.0}, {"Caf√©": "Acid cafe", "Ciudad": "Madrid", "NotaFinal": 7.93, "Local (27,5%)": 8.7, "M√∫sica (10%)": 8.75, "Servicio (7,5%)": 7.5, "Caf√© (35%)": 7.25, "Ubicaci√≥n (12,5%)": 8.0, "Precio (7,5%)": 7.5, "I": 8.7, "F": 8.7}, {"Caf√©": "Caf√© de la casa", "Ciudad": "Barcelona", "NotaFinal": 7.9, "Local (27,5%)": 7.4, "M√∫sica (10%)": 7.0, "Servicio (7,5%)": 7.75, "Caf√© (35%)": 8.6, "Ubicaci√≥n (12,5%)": 8.35, "Precio (7,5%)": 7.0, "I": 7.8, "F": 7.0}, {"Caf√©": "DUO", "Ciudad": "Barcelona", "NotaFinal": 7.89, "Local (27,5%)": 7.25, "M√∫sica (10%)": 8.5, "Servicio (7,5%)": 7.75, "Caf√© (35%)": 8.35, "Ubicaci√≥n (12,5%)": 8.0, "Precio (7,5%)": 7.25, "I": 7.5, "F": 7.0}, {"Caf√©": "La cabra", "Ciudad": "Copenhague", "NotaFinal": 7.84, "Local (27,5%)": 8.0, "M√∫sica (10%)": 8.25, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 8.5, "Ubicaci√≥n (12,5%)": 7.5, "Precio (7,5%)": 5.0, "I": 8.0, "F": 8.0}, {"Caf√©": "Sandi Cafe", "Ciudad": "Barcelona", "NotaFinal": 7.82, "Local (27,5%)": 8.5, "M√∫sica (10%)": 7.75, "Servicio (7,5%)": 5.5, "Caf√© (35%)": 8.25, "Ubicaci√≥n (12,5%)": 8.0, "Precio (7,5%)": 5.5, "I": 8.0, "F": 9.0}, {"Caf√©": "Bottega barlie", "Ciudad": "Copenhague", "NotaFinal": 7.8, "Local (27,5%)": 9.75, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 6.5, "Caf√© (35%)": 7.5, "Ubicaci√≥n (12,5%)": 7.25, "Precio (7,5%)": 4.0, "I": 9.8, "F": 9.7}, {"Caf√©": "Uaala!", "Ciudad": "Barcelona", "NotaFinal": 7.79, "Local (27,5%)": 8.25, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 7.5, "Ubicaci√≥n (12,5%)": 9.0, "Precio (7,5%)": 6.0, "I": 8.0, "F": 8.5}, {"Caf√©": "Graspa coffee", "Ciudad": "Barcelona", "NotaFinal": 7.78, "Local (27,5%)": 8.0, "M√∫sica (10%)": 6.0, "Servicio (7,5%)": 5.5, "Caf√© (35%)": 8.85, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 8.0, "I": 8.0, "F": 8.0}, {"Caf√©": "Tos tao", "Ciudad": "Barcelona", "NotaFinal": 7.77, "Local (27,5%)": 7.25, "M√∫sica (10%)": 8.25, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 8.5, "Ubicaci√≥n (12,5%)": 8.0, "Precio (7,5%)": 7.0, "I": 7.0, "F": 7.5}, {"Caf√©": "Caf√© Pendiente", "Ciudad": "Barcelona", "NotaFinal": 7.77, "Local (27,5%)": 9.72, "M√∫sica (10%)": 7.75, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 7.0, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 6.25, "I": 9.65, "F": 9.8}, {"Caf√©": "Onis", "Ciudad": "Barcelona", "NotaFinal": 7.76, "Local (27,5%)": 8.1, "M√∫sica (10%)": 9.0, "Servicio (7,5%)": 7.75, "Caf√© (35%)": 7.5, "Ubicaci√≥n (12,5%)": 7.5, "Precio (7,5%)": 6.5, "I": 8.5, "F": 7.7}, {"Caf√©": "Nook coffee", "Ciudad": "Barcelona", "NotaFinal": 7.75, "Local (27,5%)": 7.5, "M√∫sica (10%)": 9.25, "Servicio (7,5%)": 8.0, "Caf√© (35%)": 7.85, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 7.25, "I": 7.5, "F": 7.5}, {"Caf√©": "La magia", "Ciudad": "Platja d'Aro", "NotaFinal": 7.75, "Local (27,5%)": 8.38, "M√∫sica (10%)": 3.25, "Servicio (7,5%)": 6.25, "Caf√© (35%)": 8.75, "Ubicaci√≥n (12,5%)": 6.75, "Precio (7,5%)": 10.0, "I": 8.25, "F": 8.5}, {"Caf√©": "Oma", "Ciudad": "Barcelona", "NotaFinal": 7.72, "Local (27,5%)": 6.75, "M√∫sica (10%)": 6.0, "Servicio (7,5%)": 8.5, "Caf√© (35%)": 9.0, "Ubicaci√≥n (12,5%)": 8.25, "Precio (7,5%)": 6.0, "I": 6.5, "F": 7.0}, {"Caf√©": "Roses roast coffee", "Ciudad": "Madrid", "NotaFinal": 7.71, "Local (27,5%)": 7.0, "M√∫sica (10%)": 8.5, "Servicio (7,5%)": 5.0, "Caf√© (35%)": 9.5, "Ubicaci√≥n (12,5%)": 7.5, "Precio (7,5%)": 4.0, "I": 7.0, "F": 7.0}, {"Caf√©": "Niwa", "Ciudad": "Barcelona", "NotaFinal": 7.69, "Local (27,5%)": 7.0, "M√∫sica (10%)": 8.25, "Servicio (7,5%)": 6.5, "Caf√© (35%)": 8.75, "Ubicaci√≥n (12,5%)": 6.5, "Precio (7,5%)": 7.75, "I": 7.0, "F": 7.0}, {"Caf√©": "Itnig caf√© (syra coffee)", "Ciudad": "Barcelona", "NotaFinal": 7.68, "Local (27,5%)": 6.75, "M√∫sica (10%)": 6.75, "Servicio (7,5%)": 5.25, "Caf√© (35%)": 9.35, "Ubicaci√≥n (12,5%)": 6.5, "Precio (7,5%)": 9.0, "I": 6.5, "F": 7.0}, {"Caf√©": "Sitio", "Ciudad": "Barcelona", "NotaFinal": 7.68, "Local (27,5%)": 7.25, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 7.75, "Caf√© (35%)": 8.75, "Ubicaci√≥n (12,5%)": 6.75, "Precio (7,5%)": 5.25, "I": 7.5, "F": 7.0}, {"Caf√©": "Nude project caf√© (boy good news)", "Ciudad": "Barcelona", "NotaFinal": 7.65, "Local (27,5%)": 8.5, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 5.0, "Caf√© (35%)": 8.0, "Ubicaci√≥n (12,5%)": 6.5, "Precio (7,5%)": 7.0, "I": 8.5, "F": 8.5}, {"Caf√©": "Ruma's coffee", "Ciudad": "Barcelona", "NotaFinal": 7.64, "Local (27,5%)": 6.85, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 8.4, "Ubicaci√≥n (12,5%)": 8.8, "Precio (7,5%)": 5.25, "I": 7.0, "F": 6.7}, {"Caf√©": "Masamune coffee", "Ciudad": "Madrid", "NotaFinal": 7.64, "Local (27,5%)": 7.0, "M√∫sica (10%)": 7.0, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 9.0, "Ubicaci√≥n (12,5%)": 6.5, "Precio (7,5%)": 7.0, "I": 7.0, "F": 7.0}, {"Caf√©": "The Llama caf√©", "Ciudad": "Barcelona", "NotaFinal": 7.63, "Local (27,5%)": 7.75, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 6.5, "Caf√© (35%)": 7.6, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 9.0, "I": 7.5, "F": 8.0}, {"Caf√©": "Right side coffee", "Ciudad": "Barcelona", "NotaFinal": 7.62, "Local (27,5%)": 8.25, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 7.0, "Ubicaci√≥n (12,5%)": 9.0, "Precio (7,5%)": 7.0, "I": 8.5, "F": 8.0}, {"Caf√©": "Omb√∫", "Ciudad": "Barcelona", "NotaFinal": 7.62, "Local (27,5%)": 7.7, "M√∫sica (10%)": 5.0, "Servicio (7,5%)": 8.0, "Caf√© (35%)": 8.5, "Ubicaci√≥n (12,5%)": 7.5, "Precio (7,5%)": 6.5, "I": 7.7, "F": 7.7}, {"Caf√©": "Elocuente caf√©", "Ciudad": "Barcelona", "NotaFinal": 7.6, "Local (27,5%)": 8.0, "M√∫sica (10%)": 8.75, "Servicio (7,5%)": 8.4, "Caf√© (35%)": 8.25, "Ubicaci√≥n (12,5%)": 8.05, "Precio (7,5%)": 7.0, "I": 8.0, "F": 8.0}, {"Caf√©": "Maison coffee", "Ciudad": "Barcelona", "NotaFinal": 7.58, "Local (27,5%)": 7.75, "M√∫sica (10%)": 7.5, "Servicio (7,5%)": 6.25, "Caf√© (35%)": 8.6, "Ubicaci√≥n (12,5%)": 5.25, "Precio (7,5%)": 7.5, "I": 8.0, "F": 7.5}, {"Caf√©": "Oma caf√©", "Ciudad": "Barcelona", "NotaFinal": 7.56, "Local (27,5%)": 7.75, "M√∫sica (10%)": 7.0, "Servicio (7,5%)": 5.0, "Caf√© (35%)": 8.0, "Ubicaci√≥n (12,5%)": 8.1, "Precio (7,5%)": 7.25, "I": 7.5, "F": 8.0}, {"Caf√©": "Nola kitchen", "Ciudad": "Oporto", "NotaFinal": 7.55, "Local (27,5%)": 7.5, "M√∫sica (10%)": 7.75, "Servicio (7,5%)": 8.25, "Caf√© (35%)": 8.0, "Ubicaci√≥n (12,5%)": 6.75, "Precio (7,5%)": 6.0, "I": 7.5, "F": 7.5}, {"Caf√©": "Cafe labath", "Ciudad": "Barcelona", "NotaFinal": 7.54, "Local (27,5%)": 9.25, "M√∫sica (10%)": 8.5, "Servicio (7,5%)": 5.0, "Caf√© (35%)": 7.35, "Ubicaci√≥n (12,5%)": 6.6, "Precio (7,5%)": 5.0, "I": 9.3, "F": 9.2}, {"Caf√©": "Blackbird coffee", "Ciudad": "Barcelona", "NotaFinal": 7.52, "Local (27,5%)": 7.0, "M√∫sica (10%)": 8.25, "Servicio (7,5%)": 7.75, "Caf√© (35%)": 7.75, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 8.0, "I": 7.0, "F": 7.0}, {"Caf√©": "The coffee", "Ciudad": "Barcelona", "NotaFinal": 7.51, "Local (27,5%)": 7.5, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 7.5, "Ubicaci√≥n (12,5%)": 9.0, "Precio (7,5%)": 6.0, "I": 7.5, "F": 7.5}, {"Caf√©": "Noah's", "Ciudad": "Barcelona", "NotaFinal": 7.49, "Local (27,5%)": 6.75, "M√∫sica (10%)": 7.0, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 8.25, "Ubicaci√≥n (12,5%)": 7.7, "Precio (7,5%)": 7.5, "I": 7.0, "F": 6.5}, {"Caf√©": "La Tosta", "Ciudad": "Barcelona", "NotaFinal": 7.48, "Local (27,5%)": 7.25, "M√∫sica (10%)": 6.0, "Servicio (7,5%)": 4.0, "Caf√© (35%)": 8.0, "Ubicaci√≥n (12,5%)": 9.5, "Precio (7,5%)": 8.0, "I": 7.5, "F": 7.0}, {"Caf√©": "Horoscoffee", "Ciudad": "Barcelona", "NotaFinal": 7.47, "Local (27,5%)": 6.75, "M√∫sica (10%)": 8.25, "Servicio (7,5%)": 9.1, "Caf√© (35%)": 7.5, "Ubicaci√≥n (12,5%)": 8.25, "Precio (7,5%)": 6.0, "I": 7.0, "F": 6.5}, {"Caf√©": "Fauna caf√©", "Ciudad": "Barcelona", "NotaFinal": 7.42, "Local (27,5%)": 8.85, "M√∫sica (10%)": 7.4, "Servicio (7,5%)": 5.5, "Caf√© (35%)": 6.5, "Ubicaci√≥n (12,5%)": 8.85, "Precio (7,5%)": 6.0, "I": 8.7, "F": 9.0}, {"Caf√©": "P√©cora", "Ciudad": "Barcelona", "NotaFinal": 7.4, "Local (27,5%)": 8.75, "M√∫sica (10%)": 8.75, "Servicio (7,5%)": 6.75, "Caf√© (35%)": 7.0, "Ubicaci√≥n (12,5%)": 4.5, "Precio (7,5%)": 8.0, "I": 8.0, "F": 9.5}, {"Caf√©": "Flying monkeys", "Ciudad": "Barcelona", "NotaFinal": 7.4, "Local (27,5%)": 8.0, "M√∫sica (10%)": 5.0, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 8.25, "Ubicaci√≥n (12,5%)": 8.5, "Precio (7,5%)": 4.0, "I": 8.0, "F": 8.0}, {"Caf√©": "La f√°brica", "Ciudad": "Oporto", "NotaFinal": 7.35, "Local (27,5%)": 6.75, "M√∫sica (10%)": 5.5, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 8.5, "Ubicaci√≥n (12,5%)": 8.0, "Precio (7,5%)": 6.88, "I": 6.5, "F": 7.0}, {"Caf√©": "Hidden coffee", "Ciudad": "Barcelona", "NotaFinal": 7.3, "Local (27,5%)": 8.25, "M√∫sica (10%)": 8.65, "Servicio (7,5%)": 8.0, "Caf√© (35%)": 6.75, "Ubicaci√≥n (12,5%)": 7.25, "Precio (7,5%)": 4.0, "I": 8.0, "F": 8.5}, {"Caf√©": "Fiket", "Ciudad": "Barcelona", "NotaFinal": 7.28, "Local (27,5%)": 8.6, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 6.5, "Caf√© (35%)": 6.0, "Ubicaci√≥n (12,5%)": 8.65, "Precio (7,5%)": 6.0, "I": 8.5, "F": 8.7}, {"Caf√©": "Ambu coffee", "Ciudad": "Madrid", "NotaFinal": 7.22, "Local (27,5%)": 6.0, "M√∫sica (10%)": 6.25, "Servicio (7,5%)": 8.0, "Caf√© (35%)": 8.85, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 5.0, "I": 6.0, "F": 6.0}, {"Caf√©": "Salvaje cafe", "Ciudad": "Barcelona", "NotaFinal": 7.21, "Local (27,5%)": 7.5, "M√∫sica (10%)": 5.5, "Servicio (7,5%)": 7.5, "Caf√© (35%)": 7.75, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 6.0, "I": 7.5, "F": 7.5}, {"Caf√©": "Ugo's corner", "Ciudad": "Barcelona", "NotaFinal": 7.16, "Local (27,5%)": 7.0, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 7.0, "Ubicaci√≥n (12,5%)": 7.5, "Precio (7,5%)": 8.0, "I": 7.0, "F": 7.0}, {"Caf√©": "Citizen cafe", "Ciudad": "Barcelona", "NotaFinal": 7.16, "Local (27,5%)": 7.25, "M√∫sica (10%)": 5.5, "Servicio (7,5%)": 7.0, "Caf√© (35%)": 7.0, "Ubicaci√≥n (12,5%)": 8.5, "Precio (7,5%)": 7.75, "I": 7.5, "F": 7.0}, {"Caf√©": "Delta The Coffee House Experience Porto", "Ciudad": "Oporto", "NotaFinal": 7.11, "Local (27,5%)": 7.75, "M√∫sica (10%)": 5.5, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 6.88, "Ubicaci√≥n (12,5%)": 9.0, "Precio (7,5%)": 6.0, "I": 8.0, "F": 7.5}, {"Caf√©": "Onyva Coffee Galvany", "Ciudad": "Barcelona", "NotaFinal": 7.06, "Local (27,5%)": 6.5, "M√∫sica (10%)": 7.5, "Servicio (7,5%)": 7.25, "Caf√© (35%)": 8.0, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 4.0, "I": 6.0, "F": 7.0}, {"Caf√©": "Spice cafe", "Ciudad": "Barcelona", "NotaFinal": 6.97, "Local (27,5%)": 6.5, "M√∫sica (10%)": 7.65, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 7.4, "Ubicaci√≥n (12,5%)": 5.0, "Precio (7,5%)": 10.0, "I": 7.0, "F": 6.0}, {"Caf√©": "Vitrina caf√©", "Ciudad": "Barcelona", "NotaFinal": 6.79, "Local (27,5%)": 5.5, "M√∫sica (10%)": 6.0, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 7.5, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 9.75, "I": 6.0, "F": 5.0}, {"Caf√©": "Mono", "Ciudad": "Barcelona", "NotaFinal": 6.64, "Local (27,5%)": 8.0, "M√∫sica (10%)": 7.15, "Servicio (7,5%)": 5.25, "Caf√© (35%)": 6.5, "Ubicaci√≥n (12,5%)": 4.25, "Precio (7,5%)": 7.0, "I": 8.0, "F": 8.0}, {"Caf√©": "S√∫per onda", "Ciudad": "Barcelona", "NotaFinal": 6.49, "Local (27,5%)": 5.5, "M√∫sica (10%)": 8.0, "Servicio (7,5%)": 6.0, "Caf√© (35%)": 6.5, "Ubicaci√≥n (12,5%)": 6.25, "Precio (7,5%)": 9.0, "I": 5.0, "F": 6.0}, {"Caf√©": "Poblenou fresh coffee roaster", "Ciudad": "Barcelona", "NotaFinal": 5.98, "Local (27,5%)": 6.0, "M√∫sica (10%)": 6.0, "Servicio (7,5%)": 3.0, "Caf√© (35%)": 6.25, "Ubicaci√≥n (12,5%)": 6.9, "Precio (7,5%)": 6.0, "I": 6.0, "F": 6.0}, {"Caf√©": "La Cala", "Ciudad": "Barcelona", "NotaFinal": 5.89, "Local (27,5%)": 6.0, "M√∫sica (10%)": 4.5, "Servicio (7,5%)": 3.25, "Caf√© (35%)": 5.75, "Ubicaci√≥n (12,5%)": 7.0, "Precio (7,5%)": 8.75, "I": 6.0, "F": 6.0}]</script>

  <script>
    const $ = id => document.getElementById(id);
    const num = v => typeof v === 'number' ? v : (parseFloat(v) || 0);
    const uniq = a => [...new Set(a)];

    let DATA = [];

    function loadInitial(){
      try{ DATA = JSON.parse($("data").textContent); }catch(e){ DATA = []; }
    }
    function populateCities(){
      const sel = $("city");
      const cities = uniq(DATA.map(r=>r['Ciudad']).filter(Boolean)).sort((a,b)=> a.localeCompare(b));
      sel.innerHTML = '<option value="">Todas</option>' + cities.map(c=>`<option value="${c}">${c}</option>`).join('');
    }
    function activeChips(q, city, mins){
      const chips = [];
      if(q) chips.push(`Buscar: "${q}"`);
      if(city) chips.push(`Ciudad: ${city}`);
      Object.entries(mins).forEach(([k,v])=>{ if(v>0){ chips.push(`${k} ‚â• ${v.toFixed(1)}`); }});
      $("chips").innerHTML = chips.map(t=>`<span class="chip">${t}</span>`).join('');
    }
    function render(){
      const q = $("q").value.trim().toLowerCase();
      const city = $("city").value;
      const mins = {
        'Nota final': num($("minFinal").value),
        'Local': num($("minLocal").value),
        'Caf√©': num($("minCafe").value),
        'M√∫sica': num($("minMusica").value),
        'Servicio': num($("minServicio").value),
        'Ubicaci√≥n': num($("minUbicacion").value),
        'Precio': num($("minPrecio").value),
      };
      const [key,dir] = $("sort").value.split('-');

      let rows = DATA.filter(r =>
        (!q || r['Caf√©'].toLowerCase().includes(q) || (r['Ciudad']||'').toLowerCase().includes(q)) &&
        (!city || r['Ciudad']===city) &&
        (r['NotaFinal']||0) >= mins['Nota final'] &&
        (r['Local (27,5%)']||0) >= mins['Local'] &&
        (r['Caf√© (35%)']||0) >= mins['Caf√©'] &&
        (r['M√∫sica (10%)']||0) >= mins['M√∫sica'] &&
        (r['Servicio (7,5%)']||0) >= mins['Servicio'] &&
        (r['Ubicaci√≥n (12,5%)']||0) >= mins['Ubicaci√≥n'] &&
        (r['Precio (7,5%)']||0) >= mins['Precio']
      );

      rows.sort((a,b)=>{
        const A = a[key] ?? '';
        const B = b[key] ?? '';
        if(typeof A === 'number' && typeof B === 'number') return dir==='asc' ? A-B : B-A;
        return dir==='asc' ? String(A).localeCompare(String(B)) : String(B).localeCompare(String(A));
      });

      const grid = $("grid"); grid.innerHTML = '';
      rows.forEach(r=>{
        const pct = Math.max(0, Math.min(100, (r['NotaFinal']||0)*10));
        const el = document.createElement('div');
        el.className = 'card';
        el.innerHTML = `
          <div class="row">
            <strong style="font-size:16px">${r['Caf√©']}</strong>
            <div class="badge">${(r['NotaFinal']||0).toFixed(2)}</div>
          </div>
          <div class="row">
            <span class="city">${r['Ciudad']||''}</span>
            <span class="city">I ${(r['I']||0).toFixed(1)} ¬∑ F ${(r['F']||0).toFixed(1)}</span>
          </div>
          <div class="progress"><div class="bar" style="width:${pct}%"></div></div>
          <div class="meta">
            <div><b>Local</b><br>${(r['Local (27,5%)']||0).toFixed(1)}</div>
            <div><b>Caf√©</b><br>${(r['Caf√© (35%)']||0).toFixed(1)}</div>
            <div><b>Servicio</b><br>${(r['Servicio (7,5%)']||0).toFixed(1)}</div>
            <div><b>M√∫sica</b><br>${(r['M√∫sica (10%)']||0).toFixed(1)}</div>
            <div><b>Ubicaci√≥n</b><br>${(r['Ubicaci√≥n (12,5%)']||0).toFixed(1)}</div>
            <div><b>Precio</b><br>${(r['Precio (7,5%)']||0).toFixed(1)}</div>
          </div>
        `;
        grid.appendChild(el);
      });

      $("count").textContent = `Resultados: ${rows.length}`;
      activeChips(q, city, mins);
    }
    function attach(){
      const link = (id, fn) => $(id).addEventListener('input', fn);
      ['q','city','minFinal','minLocal','minCafe','minMusica','minServicio','minUbicacion','minPrecio','sort'].forEach(id=> link(id, render));
      const sync = (id, out) => $(id).addEventListener('input', ()=> $(out).textContent = Number($(id).value).toFixed(1));
      sync('minLocal','valLocal'); sync('minCafe','valCafe'); sync('minMusica','valMusica'); sync('minServicio','valServicio'); sync('minUbicacion','valUbicacion'); sync('minPrecio','valPrecio');
      $("reset").addEventListener('click', ()=>{
        $("q").value=''; $("city").value=''; $("minFinal").value=0;
        ['minLocal','minCafe','minMusica','minServicio','minUbicacion','minPrecio'].forEach(id=> $(id).value=0);
        ['valLocal','valCafe','valMusica','valServicio','valUbicacion','valPrecio'].forEach(id=> $(id).textContent='0.0');
        $("sort").value='NotaFinal-desc'; render();
      });
      $("file").addEventListener('change', async ev =>{
        const f = ev.target.files?.[0]; if(!f) return;
        const txt = await f.text();
        try{ DATA = JSON.parse(txt); }catch(e){ alert('JSON inv√°lido'); return; }
        populateCities(); render();
      });
    }
    loadInitial(); populateCities(); attach(); render();
  </script>
</body>
</html>
